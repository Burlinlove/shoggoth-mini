
# 🎮 触手手动控制脚本使用指南

本文档介绍如何使用手动控制脚本来交互式控制MuJoCo触手机器人。

## 📋 脚本概览

### 1. `simple_manual_control.py` - 简化版本 ⭐ 推荐新手
- **特点**: 简单易用，代码少，快速上手
- **功能**: WASD控制，实时状态显示
- **适用**: 快速测试，学习基础控制

### 2. `manual_tentacle_control.py` - 完整版本 🚀 功能丰富
- **特点**: 功能完整，可配置参数，详细反馈
- **功能**: 高级控制，参数调节，历史记录
- **适用**: 深度研究，精确控制，开发调试

## 🚀 快速开始

### 方法1: 简化版本（推荐新手）
```bash
# macOS (推荐)
mjpython simple_manual_control.py

# Linux/Windows
python simple_manual_control.py
```

### 方法2: 完整版本（高级用户）
```bash
# macOS (推荐)  
mjpython manual_tentacle_control.py

# Linux/Windows
python manual_tentacle_control.py
```

## 🎮 控制说明

### 基础控制 (两个脚本通用)
| 按键 | 功能 |
|------|------|
| **W** / **↑** | 触手向上弯曲 |
| **S** / **↓** | 触手向下弯曲 |
| **A** / **←** | 触手向左弯曲 |
| **D** / **→** | 触手向右弯曲 |
| **SPACE** | 重置到中心位置 |
| **ESC** | 退出程序 |

### 高级控制 (仅完整版本)
| 按键 | 功能 |
|------|------|
| **R** | 重置光标到中心 |
| **C** | 开启/关闭自动回中 |
| **H** | 显示/隐藏帮助信息 |
| **+** | 增加控制速度 |
| **-** | 减少控制速度 |
| **SPACE** | 暂停/继续仿真 |

## 📊 界面说明

### 简化版本显示信息
```
🎮 光标:[0.25,-0.18] | 尖端:[0.15,-0.12,0.23] | 腱绳:[0.23,0.27,0.25]
```
- **光标**: 当前2D控制位置 [-1,1] 范围
- **尖端**: 触手尖端的3D坐标 (米)
- **腱绳**: 三条腱绳的当前长度 (米)

### 完整版本显示信息
```
🎮 光标: [0.296, -0.280] | 强度: 0.41 | 尖端: [0.150, -0.120, 0.234] | 腱绳: [0.23, 0.27, 0.25]
```
- **强度**: 光标到中心的距离 (控制强度)
- 其他信息同简化版本

## ⚙️ 参数配置 (完整版本)

### 默认参数
```python
控制速度: 0.020      # 键盘控制的灵敏度
最大范围: 0.800      # 光标最大移动范围  
自动回中: 关闭        # 松开按键后是否自动回中心
基准长度: [0.25, 0.25, 0.25]  # 三条腱绳的中性长度
```

### 实时调节
- 使用 **+/-** 键调节控制速度
- 使用 **C** 键切换自动回中模式
- 使用 **H** 键查看详细帮助

## 🎯 控制原理

### 2D → 3D 映射
```
2D光标输入 [x, y] → 3条腱绳长度 [L1, L2, L3]

腱绳分布 (120°均匀分布):
- 腱绳1: [0.0,   1.0]   上方
- 腱绳2: [0.866, -0.5]  右下方  
- 腱绳3: [-0.866, -0.5] 左下方
```

### 控制效果
- **向上控制 (W)**: 腱绳1收缩，触手向上弯曲
- **向右下控制 (D+S)**: 腱绳2收缩，触手向右下弯曲  
- **组合控制**: 多个方向同时按下，产生斜对角运动

## 🛠️ 故障排除

### 常见问题

1. **模型加载失败**
   ```
   ❌ 模型加载失败: [Errno 2] No such file or directory
   ```
   **解决**: 确保在项目根目录运行，且 `assets/simulation/tentacle.xml` 存在

2. **可视化窗口无法打开 (macOS)**
   ```
   ❌ 运行错误: OpenGL context creation failed
   ```
   **解决**: 使用 `mjpython` 而不是 `python`

3. **导入模块失败**
   ```
   警告: 无法导入项目模块，使用简化控制模式
   ```
   **解决**: 这是正常的fallback，脚本会使用内置的简化控制

4. **控制无响应**
   - 检查MuJoCo窗口是否有焦点
   - 尝试点击窗口激活
   - 按 **H** 键查看帮助信息

### 性能优化

- **减少历史记录**: 修改 `max_history = 100` (默认1000)
- **降低更新频率**: 增加 `time.sleep()` 时间
- **关闭信息显示**: 按相关键关闭实时信息显示

## 📈 进阶使用

### 自定义模型路径
```bash
python manual_tentacle_control.py path/to/your/model.xml
```

### 录制运动轨迹 (完整版本)
脚本会自动记录触手尖端轨迹，存储在 `tip_history` 列表中，可用于分析和可视化。

### 扩展功能
- 修改 `baseline_lengths` 改变默认腱绳长度
- 调节 `actuator_low/high` 改变腱绳长度范围
- 修改控制映射函数实现不同的控制策略

## 🎊 开始体验

现在你可以开始体验手动控制触手机器人了！

**推荐流程**:
1. 先运行简化版本熟悉基本控制
2. 然后尝试完整版本体验高级功能
3. 根据需要修改参数和控制逻辑

享受控制3D触手的乐趣吧！ 🦾✨
